import{j as s,R as I,r as w,u as D}from"./entry-index-B-fzmtso.js";import{u as E}from"./chunk-NodeDetailsContext-C405bEFp.js";import{T as H,a as P,c as L,d as z,b as N,e as x}from"./chunk-table-CFAkpkHt.js";import{S as B}from"./chunk-search-SRY80dSo.js";import{u as M,c as V}from"./chunk-text-field-BEd1A3G3.js";import{c as b}from"./chunk-checkbox-DtfZQmnL.js";function q(i){const{className:f="",hiddenDescription:j=!1,value:g,onChange:t,items:d,getId:n,getLabel:c,sortItems:a,filterItem:h,searchPlaceholder:T="Search…",headerLabel:R="Items"}=i,l=g??[],[m,y]=I.useState(""),S=I.useMemo(()=>{let e=[...d];if(a&&e.sort(a),m.trim()){const r=m.toLowerCase();e=e.filter(o=>h?h(o,m):String(c(o)).toLowerCase().includes(r))}return e},[d,a,h,m,c]),u=S.map(n),C=u.length>0&&u.every(e=>l.includes(e)),k=l.length>0&&l.some(e=>u.includes(e))&&!C,A=l.filter(e=>!d.some(r=>n(r)===e)),p=w.useRef(null);w.useEffect(()=>{p.current&&(p.current.indeterminate=k)},[k]);const $=e=>{t(e?Array.from(new Set([...l,...u])):l.filter(r=>!u.includes(r)))},v=(e,r)=>{t(r?Array.from(new Set([...l,e])):l.filter(o=>o!==e))};return s.jsxs("div",{className:`flex flex-col ${f}`,children:[s.jsx(M,{className:"mb-2 flex items-center gap-1",placeholder:T,value:m,onChange:e=>y(e.target.value),children:s.jsx(V,{children:s.jsx(B,{size:"16"})})}),s.jsx("div",{className:"selector rounded-md overflow-hidden",children:s.jsxs(H,{children:[s.jsxs(P,{children:[s.jsx(L,{children:s.jsx(b,{ref:p,checked:C,onCheckedChange:e=>$(!!e),"aria-label":"Select all"})}),s.jsx(L,{children:R})]}),s.jsxs(z,{children:[S.map(e=>{const r=n(e);return s.jsxs(N,{children:[s.jsx(x,{children:s.jsx(b,{checked:l.includes(r),onCheckedChange:o=>v(r,!!o),"aria-label":`Select ${r}`})}),s.jsx(x,{children:c(e)})]},r)}),A.map(e=>s.jsxs(N,{children:[s.jsx(x,{children:s.jsx(b,{checked:l.includes(e),onCheckedChange:r=>v(e,!!r),"aria-label":`Select ${e}`})}),s.jsx(x,{children:e})]},e))]})]})}),!j&&s.jsxs("label",{className:"text-sm text-gray-500",children:["已选择 ",l.length]})]})}function F(i){return s.jsx(q,{...i})}const W=({className:i="",hiddenDescription:f=!1,value:j,onChange:g})=>{const{nodeDetail:t,isLoading:d,error:n}=E(),{t:c}=D();return d?s.jsx("div",{children:"Loading..."}):n?s.jsx("div",{children:n}):s.jsx(F,{className:i,hiddenDescription:f,value:j,onChange:g,items:[...t],sortItems:(a,h)=>(a.weight??0)-(h.weight??0),getId:a=>a.uuid,getLabel:a=>a.name,searchPlaceholder:c("common.search"),headerLabel:c("common.server")})};export{W as N,F as S};
